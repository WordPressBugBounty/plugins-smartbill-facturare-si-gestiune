!function(e){"use strict";var t=[],a=[];function i(){"undefined"!=typeof Storage&&("undefined"!=localStorage.successMessages&&(localStorage.successMessages=JSON.stringify(t)),"undefined"!=localStorage.errorMessages&&(localStorage.errorMessages=JSON.stringify(a)),"undefined"!=localStorage.path&&(localStorage.path=window.location.pathname))}function n(e){for(var t=[["amp","&"],["apos","'"],["#x27","'"],["#x2F","/"],["#39","'"],["#47","/"],["lt","<"],["gt",">"],["nbsp"," "],["quot",'"']],a=0,i=t.length;a<i;++a)e=e.replace(new RegExp("&"+t[a][0]+";","g"),t[a][1]);return e=(e=e.replace(new RegExp("</b>","g"),"</strong>")).replace(new RegExp("<b>","g"),"<strong>")}e(document).ready((function(){var r;r=window.location.pathname,"undefined"!=typeof Storage&&"undefined"!=localStorage.path&&(r==localStorage.path?(""==localStorage.successMessages&&"undefined"==localStorage.successMessages||JSON.parse(localStorage.successMessages).forEach((function(e,t,a){Toastify({text:e,duration:3e3,newWindow:!1,close:!0,escapeMarkup:!1,gravity:"top",position:"center",backgroundColor:"#00A14B",stopOnFocus:!0}).showToast(),t===a.length-1&&localStorage.removeItem("successMessages")})),""==localStorage.errorMessages&&"undefined"==localStorage.errorMessages||JSON.parse(localStorage.errorMessages).forEach((function(e,t,a){Toastify({text:e,duration:-1,newWindow:!1,close:!0,escapeMarkup:!1,gravity:"top",position:"center",backgroundColor:"#EF4136",stopOnFocus:!0}).showToast(),t===a.length-1&&localStorage.removeItem("errorMessages")})),localStorage.removeItem("path")):(localStorage.removeItem("path"),localStorage.removeItem("successMessages"),localStorage.removeItem("errorMessages"))),e("#smrt-order-select").select2(),e("#smartbill-manually-sync-stock").click((function(t){t.preventDefault();var n=e("select[name=smartbill_plugin_options_settings\\[used_stock\\]]").find(":selected").val(),r=document.createElement("div");""==n||"fara-gestiune"==n?Toastify({text:"Este necesara selectarea gestiunii din care vor fi preluate stocurile.",duration:-1,escapeMarkup:!1,newWindow:!1,close:!0,gravity:"top",position:"center",backgroundColor:"#EF4136",stopOnFocus:!0}).showToast():(r.innerHTML="Stocurile produselor din WooCommerce <strong>vor fi actualizate</strong> cu stocurile produselor din <strong>gestiunea "+n+"</strong>.",Swal.fire({title:"Atentie!",html:r,icon:"warning",showCancelButton:!0,buttonsStyling:!0,reverseButtons:!0,confirmButtonText:"Actualizeaza stocuri",cancelButtonText:"Renunta"}).then((function(t){if(t.isDismissed)return!1;(r=document.createElement("div")).innerHTML="Va rugam asteptati finalizarea preluarii...",Swal.fire({title:"Se incarca!",html:r,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1}),e.ajax({url:ajaxurl,type:"post",data:{security:smartbill.security,body:n,action:"smartbill_woocommerce_manually_sync_stock"},success:function(t){try{if(t=JSON.parse(t),(r=document.createElement("div")).innerHTML=t.data,null==t.data)throw t.error;Swal.close(),Swal.fire({title:"",html:r,icon:t.icon,showCancelButton:!0,buttonsStyling:!0,reverseButtons:!0,confirmButtonText:"Descarca istoric",cancelButtonText:"Am inteles"}).then((function(t){if(t.isDismissed)return!1;Swal.fire({title:"Descarcarea documentului va incepe curand…",html:document.createElement("div"),icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1}),e.ajax({url:ajaxurl,type:"post",data:{security:smartbill.security,action:"smartbill_woocommerce_download_manual_stock_history"},success:function(e){e=JSON.parse(e);try{if(null==e.data)throw e.error;Swal.close(),location.href=e.data}catch(e){a.push(e),i(),location.reload()}},error:function(e,t,n){a.push(n),i(),location.reload()}})}))}catch(e){a.push(e),i(),location.reload()}},error:function(e,t,n){a.push(n),i(),location.reload()}})})))})),e("#smartbill-download-sync-stock-history").click((function(t){t.preventDefault(),Swal.fire({title:"Descarcarea documentului va incepe curand…",html:document.createElement("div"),icon:"warning",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1}),e.ajax({url:ajaxurl,type:"post",data:{security:smartbill.security,action:"smartbill_woocommerce_download_stock_history"},success:function(e){e=JSON.parse(e);try{if(null==e.data)throw e.error;Swal.close(),location.href=e.data}catch(e){a.push(e),i(),location.reload()}},error:function(e,t,n){a.push(n),i(),location.reload()}})})),e("#export-settings").click((function(t){t.preventDefault(),smartbill_export.setariEmitere.moneda=e('select[name="smartbill_plugin_options_settings[billing_currency]"]').find(":selected").text();var a=new Date,i=a.getFullYear()+"-"+("0"+(a.getMonth()+1)).slice(-2)+"-"+("0"+a.getDate()).slice(-2)+" "+("0"+a.getHours()).slice(-2)+"_"+("0"+a.getMinutes()).slice(-2)+"_"+("0"+a.getSeconds()).slice(-2);smartbill_export.versiuni.data_export=i;var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(smartbill_export)),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download","smartbill_modul_setari.json"),document.body.appendChild(r),r.click(),r.remove()})),e("#get-smartbill-setting").click((function(n){n.preventDefault(),Swal.fire({title:"Se preiau informatiile din SmartBill…",html:document.createElement("div"),icon:"warning",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1}),e.ajax({url:ajaxurl,type:"post",data:{security:smartbill.security,action:"smartbill_woocommerce_sync_settings"},success:function(e){""!=(e=JSON.parse(e)).message&&t.push(e.message),""!=e.error&&t.push(e.error),i(),location.reload()},error:function(e,t,n){a.push(n),i(),location.reload()}})})),e('button[name="save"].save_order.button-primary').click((function(t){if(t.detail&&1!=t.detail)return!1;var a;0!==smartbill.woocommerce_status.length&&(Array.isArray(smartbill.woocommerce_status)||(smartbill.woocommerce_status=[smartbill.woocommerce_status]),smartbill.woocommerce_status.includes(e("#order_status").val())&&(0===e("#smartbill-woocommerce-view-document-button").length?(t.preventDefault(),(a=document.createElement("div")).innerHTML="Comanda #"+smartbill.post_id+" va fi emisa in SmartBill.",Swal.fire({title:"Modulul SmartBill a detectat modificarea statusului comenzii",html:a,icon:"warning",showCancelButton:!0,buttonsStyling:!0,reverseButtons:!0,confirmButtonText:"Emite document",cancelButtonText:"Mai tarziu"}).then((async function(a){if(a.isDismissed)return e(t.currentTarget.form).submit(),!1;var i={data:{type:2,order_id:smartbill.post_id},security:smartbill.security,action:"smartbill_woocommerce_issue_document"};await d(i,!1,!0).then((function(){e(t.currentTarget.form).submit()}))}))):(t.preventDefault(),a=document.createElement("div"),i(),a.innerHTML="Te informam ca nu se va emite automat o alta comanda in SmartBill.",Swal.fire({title:"Comanda a fost deja facturata in SmartBill. ",html:a,icon:"warning",buttonsStyling:!0,reverseButtons:!0,confirmButtonText:"Continua"}).then((function(a){e(t.currentTarget.form).submit()})))))}));var s=e("#smartbill_woocommerce_meta_box");s.length&&s.prependTo(s.parent()),"1"==smartbill.send_mail_with_document&&e("<option>").val("smartbill_send_documents_to_client").text("Trimite factura clientului").appendTo("select[name='action'], select[name='action2']"),e("<option>").val("smartbill_generate_documents").text("Emite documente in SmartBill").appendTo("select[name='action'], select[name='action2']"),e("#doaction2").click((function(t){t.detail&&1!=t.detail||(e("#doaction2").removeAttr("onclick"),e("#doaction2").css("pointer-events","none"))})),e("#doaction").click((function(t){if(t.detail&&1!=t.detail)return!1;var a,i=e(this).siblings("select"),n=[],r=[],s=e('input[name="id[]"]:checked');if(0===s.length&&(s=e('input[name="post[]"]:checked')),s.each((function(t,a){e(a).parent().siblings(".smartbill_woocommerce_invoice").find("a").length?r.push(a):n.push(a)})),n.sort(((e,t)=>e.value>t.value?1:-1)),r.sort(((e,t)=>e.value>t.value?1:-1)),"smartbill_generate_documents"==i.val())if(t.preventDefault(),n.length)if(r.length)(a=document.createElement("div")).innerHTML="Exista comenzi care au fost deja facturate. <br/> Doar comenzile nefacturate vor fi emise in SmartBill.",1==r.length&&(a.innerHTML="Exista o comanda care a fost deja facturata. <br/> Doar comenzile nefacturate vor fi emise in SmartBill."),1==n.length&&(a.innerHTML="Exista comenzi care au fost deja facturate. <br/> Doar comanda nefacturata va fi emisa in SmartBill."),1==r.length&&1==n.length&&(a.innerHTML="Exista o comanda care a fost deja facturata. <br/> Doar comanda nefacturata va fi emisa in SmartBill."),Swal.fire({title:"Atentie!",html:a,icon:"warning",showCancelButton:!0,buttonsStyling:!0,reverseButtons:!0,confirmButtonText:"Emite in SmartBill",cancelButtonText:"Renunta"}).then((function(t){if(t.isDismissed)return!1;var a=document.createElement("div");a.innerHTML="Va rugam asteptati raspunsul serverului...",Swal.fire({title:"Se incarca!",html:a,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1});(async()=>{await l(n,(async(t,a)=>{var i=!0;a>0&&(i=!1);var n={data:{type:3,order_id:parseInt(e(t).val()),is_first:i},security:smartbill.security,action:"smartbill_woocommerce_issue_document"},r=await d(n,!0,!1);if((r=JSON.parse(r)).hasOwnProperty("headers")&&parseInt(r.headers["x-ratelimit-remaining"])<=4){var s=Math.floor(new Date(1e3*parseInt(r.headers["x-ratelimit-reset"])).getTime()/1e3),o=Math.floor((new Date).getTime()/1e3),l=Math.abs(o-s)*(5-parseInt(r.headers["x-ratelimit-remaining"]))*1e3;await c(l)}}))})().then((function(){Swal.close(),window.location.reload()}))}));else{t.preventDefault(),(u=document.createElement("div")).innerHTML="Va rugam asteptati raspunsul serverului...",Swal.fire({title:"Se incarca!",html:u,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1});(async()=>{await l(n,(async(t,a)=>{var i=!0;a>0&&(i=!1);var n={data:{type:4,order_id:parseInt(e(t).val()),is_first:i},security:smartbill.security,action:"smartbill_woocommerce_issue_document"},r=await d(n,!0,!1);if((r=JSON.parse(r)).hasOwnProperty("headers")&&parseInt(r.headers["x-ratelimit-remaining"])<=4){var s=Math.floor(new Date(1e3*parseInt(r.headers["x-ratelimit-reset"])).getTime()/1e3),o=Math.floor((new Date).getTime()/1e3),l=Math.abs(o-s)*(5-parseInt(r.headers["x-ratelimit-remaining"]))*1e3;await c(l)}}))})().then((function(){Swal.close(),window.location.reload()}))}else r.length&&((a=document.createElement("div")).innerHTML="Comenzile selectate sunt deja facturate in SmartBill.",1==r.length&&(a.innerHTML="Comanda selectata este deja facturata in SmartBill."),Swal.fire({title:"Atentie!",html:a,icon:"warning",showCancelButton:!0,buttonsStyling:!0,reverseButtons:!0,cancelButtonText:"Renunta",confirmButtonText:"Reemite in SmartBill"}).then((function(t){if(t.isDismissed)return!1;var a=document.createElement("div");a.innerHTML="Va rugam asteptati raspunsul serverului...",Swal.fire({title:"Se incarca!",html:a,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1});(async()=>{await l(r,(async(t,a)=>{var i=!0;a>0&&(i=!1);var n={data:{type:5,order_id:parseInt(e(t).val()),is_first:i},security:smartbill.security,action:"smartbill_woocommerce_issue_document"},r=await d(n,!0,!1);if((r=JSON.parse(r)).hasOwnProperty("headers")&&parseInt(r.headers["x-ratelimit-remaining"])<=4){var s=Math.floor(new Date(1e3*parseInt(r.headers["x-ratelimit-reset"])).getTime()/1e3),o=Math.floor((new Date).getTime()/1e3),l=Math.abs(o-s)*(5-parseInt(r.headers["x-ratelimit-remaining"]))*1e3;await c(l)}}))})().then((function(){Swal.close(),window.location.reload()}))})));else if("smartbill_send_documents_to_client"==i.val()){if("1"==smartbill.send_mail_with_document)if(t.preventDefault(),r.length)if(n.length){var o="Trimite documente clientilor";(a=document.createElement("div")).innerHTML="Exista comenzi care nu au fost facturate. <br/> Doar comenzile facturate vor fi trimise prin e-mail clientilor.",1==r.length&&(a.innerHTML="O comanda nu a fost facturata. <br/> Doar comenzile facturate vor fi trimise prin e-mail clientilor.",o="Trimite documentul clientului"),Swal.fire({title:"Atentie!",html:a,icon:"warning",buttonsStyling:!0,reverseButtons:!0,showCancelButton:!0,confirmButtonText:o,cancelButtonText:"Renunta"}).then((function(t){if(t.isDismissed)return!1;var a=document.createElement("div");a.innerHTML="Va rugam asteptati raspunsul serverului...",Swal.fire({title:"Se incarca!",html:a,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1});(async()=>{await l(r,(async(t,a)=>{var i=!0;a>0&&(i=!1);var n={data:{type:6,order_id:parseInt(e(t).val()),is_first:i},security:smartbill.security,action:"smartbill_woocommerce_issue_document"},r=await m(n,!0,!1);if((r=JSON.parse(r)).hasOwnProperty("headers")&&parseInt(r.headers["x-ratelimit-remaining"])<=4){var s=Math.floor(new Date(1e3*parseInt(r.headers["x-ratelimit-reset"])).getTime()/1e3),o=Math.floor((new Date).getTime()/1e3),l=Math.abs(o-s)*(5-parseInt(r.headers["x-ratelimit-remaining"]))*1e3;await c(l)}}))})().then((function(){Swal.close(),window.location.reload()}))}))}else{var u;t.preventDefault(),(u=document.createElement("div")).innerHTML="Va rugam asteptati raspunsul serverului...",Swal.fire({title:"Se incarca!",html:u,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1});(async()=>{await l(r,(async(t,a)=>{var i=!0;a>0&&(i=!1);var n={data:{type:7,order_id:parseInt(e(t).val()),is_first:i},security:smartbill.security,action:"smartbill_woocommerce_issue_document"},r=await m(n,!0,!1);if((r=JSON.parse(r)).hasOwnProperty("headers")&&parseInt(r.headers["x-ratelimit-remaining"])<=4){var s=Math.floor(new Date(1e3*parseInt(r.headers["x-ratelimit-reset"])).getTime()/1e3),o=Math.floor((new Date).getTime()/1e3),l=Math.abs(o-s)*(5-parseInt(r.headers["x-ratelimit-remaining"]))*1e3;await c(l)}}))})().then((function(){Swal.close(),window.location.reload()}))}else n.length&&((a=document.createElement("div")).innerHTML="Comenzile selectate nu sunt facturate in SmartBill.",1==n.length&&(a.innerHTML="Comanda selectata nu este facturata in SmartBill."),Swal.fire({title:"Atentie!",html:a,icon:"warning",showCancelButton:!0,confirmButtonText:"Emite in SmartBill",cancelButtonText:"Renunta"}).then((function(t){if(t.isDismissed)return!1;var a=document.createElement("div");a.innerHTML="Va rugam asteptati raspunsul serverului...",Swal.fire({title:"Se incarca!",html:a,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1});(async()=>{await l(n,(async(t,a)=>{var i=!0;a>0&&(i=!1);var n={data:{type:8,order_id:parseInt(e(t).val()),is_first:i},security:smartbill.security,action:"smartbill_woocommerce_issue_document"},r=await d(n,!0,!1);if((r=JSON.parse(r)).hasOwnProperty("headers")&&parseInt(r.headers["x-ratelimit-remaining"])<=4){var s=Math.floor(new Date(1e3*parseInt(r.headers["x-ratelimit-reset"])).getTime()/1e3),o=Math.floor((new Date).getTime()/1e3),l=Math.abs(o-s)*(5-parseInt(r.headers["x-ratelimit-remaining"]))*1e3;await c(l)}}))})().then((function(){Swal.close(),window.location.reload()}))})))}else if(-1!==i.val().indexOf("mark_")&&0!==smartbill.woocommerce_status.length&&(Array.isArray(smartbill.woocommerce_status)||(smartbill.woocommerce_status=[smartbill.woocommerce_status]),smartbill.woocommerce_status.includes(i.val().replace("mark_","wc-"))&&n.length)){t.preventDefault(),a=document.createElement("div");var f="Modulul SmartBill a detectat modificarea statusului comenzilor.",h=[],p="Emite documente";n.forEach((function(t,a){var i=parseInt(e(t).val());h.push("#"+i)})),n.sort(((e,t)=>e.value>t.value?1:-1)),a.innerHTML="Comenzile "+h.join(", ")+" vor fi emise in SmartBill.",1==n.length&&(a.innerHTML="Comanda "+h.join(", ")+" va fi emisa in SmartBill.",f="Modulul SmartBill a detectat modificarea statusului unei comenzi.",p="Emite document"),Swal.fire({title:f,html:a,icon:"warning",showCancelButton:!0,buttonsStyling:!0,reverseButtons:!0,confirmButtonText:p,cancelButtonText:"Mai tarziu"}).then((async function(a){if(a.isDismissed)e(t.currentTarget.form).submit();else{var i=document.createElement("div");i.innerHTML="Va rugam asteptati raspunsul serverului...",Swal.fire({title:"Se incarca!",html:i,icon:"info",buttonsStyling:!0,reverseButtons:!0,showCancelButton:!1});const a=async()=>{await l(n,(async(t,a)=>{var i=!0;a>0&&(i=!1);var n={data:{type:9,order_id:parseInt(e(t).val()),is_first:i},security:smartbill.security,action:"smartbill_woocommerce_issue_document"},r=await d(n,!0,!1);if((r=JSON.parse(r)).hasOwnProperty("headers")&&parseInt(r.headers["x-ratelimit-remaining"])<=4){var s=Math.floor(new Date(1e3*parseInt(r.headers["x-ratelimit-reset"])).getTime()/1e3),o=Math.floor((new Date).getTime()/1e3),l=Math.abs(o-s)*(5-parseInt(r.headers["x-ratelimit-remaining"]))*1e3;await c(l)}}))};a().then((function(){Swal.close(),e(t.currentTarget.form).submit()}))}}))}})),"undefined"!=typeof hide_toast&&(hide_toast[0]?"no_value"==e("#smartbill_settings_display_um").find("option:selected").val()&&Toastify({text:'Este necesara selectarea unei unitati de masura. <br/> Configureaza setarea in zona <strong><a style="color:white;" href="'+window.location.href+'#smartbill_settings_display_um">Setari produse</a></strong> si salveaza din nou.',duration:-1,escapeMarkup:!1,newWindow:!1,close:!0,gravity:"top",position:"center",backgroundColor:"#EF4136",stopOnFocus:!0}).showToast():Toastify({text:"Verifica toate setarile modulului pentru a te asigura ca facturarea comenzilor in SmartBill se va face corect.",duration:-1,escapeMarkup:!1,newWindow:!1,close:!0,gravity:"top",position:"center",backgroundColor:"#2271b1",stopOnFocus:!0}).showToast()),e("#smartbill_plugin_options_settings_document_series").click((function(){0==e(this).children().size()&&e(this).closest("td").find("div").removeClass("hide-element")})),e("#smartbill_settings_display_stock").click((function(){1==e(this).children().size()&&e(this).closest("td").find("div").removeClass("hide-element")})),e("#smartbill_settings_display_um").click((function(){0!=e(this).children().size()&&1!=e(this).children().size()||e(this).closest("td").find("div").removeClass("hide-element")}));async function o(t){if(t.preventDefault(),t.detail&&1!=t.detail)return!1;var a;try{var i={data:{type:10,order_id:smartbill.post_id},security:smartbill.security,action:"smartbill_woocommerce_issue_document"};"order"in e(t.currentTarget).data()&&(i.data.order_id=e(t.currentTarget).data().order),e(this).hasClass("reissue")?((a=document.createElement("div")).innerHTML="Comanda a fost deja facturata in SmartBill.<br/>Inainte de reemitere va recomandam sa anulati sau sa stergeti documentul emis anterior.",Swal.fire({title:"Atentie!",html:a,icon:"warning",showCancelButton:!0,buttonsStyling:!0,reverseButtons:!0,confirmButtonText:"Reemite in SmartBill",cancelButtonText:"Renunta"}).then((async function(e){if(e.isDismissed)return!1;await d(i,!1,!0).then((function(){window.location.reload()}))}))):await d(i,!1,!0).then((function(){window.location.reload()}))}catch(t){Swal.close(),(a=document.createElement("div")).innerHTML=t.responseText,Swal.fire({title:"Atentie!",html:a,buttonsStyling:!0,reverseButtons:!0,icon:"error"}).then((function(e){return!1}))}}async function l(e,t){for(let a=0;a<e.length;a++)await t(e[a],a,e)}e("#url_container_stocks strong").click((function(e){navigator.clipboard.writeText(this.innerText),Toastify({text:"URL-ul a fost copiat cu succes!",duration:3e3,newWindow:!1,escapeMarkup:!1,close:!0,gravity:"top",position:"center",backgroundColor:"#00A14B",stopOnFocus:!0}).showToast()})),e(".smartbill_sync_stock").click((function(t){1==e(this).val()?(e(".token-details").show(),e(".smartbill-show-sync-stock-both-ways").show()):(e(".token-details").hide(),e(".smartbill-show-sync-stock-both-ways").hide())})),1==e(".smartbill_sync_stock").val()&&(e(".token-details").show(),e(".smartbill-show-sync-stock-both-ways").show()),e("#custom-checkout").click((function(t){1==e(this).val()?e("#custom-checkout-options-table").closest("tr").show():e("#custom-checkout-options-table").closest("tr").hide()})),1==e("#custom-checkout").val()?e("#custom-checkout-options-table").closest("tr").show():e("#custom-checkout-options-table").closest("tr").hide(),e(".show_delivery_days").click((function(t){1==e(this).val()?e(".smartbill-show-if-delivery-days-on").show():e(".smartbill-show-if-delivery-days-on").hide()})),1==e(".show_delivery_days").val()&&e(".smartbill-show-if-delivery-days-on").show(),e(".show_shipping_cost").click((function(t){1==e(this).val()?e(".smartbill-show-if-shipping-cost-is-included").show():e(".smartbill-show-if-shipping-cost-is-included").hide()})),0==e(".show_shipping_cost").val()&&e(".smartbill-show-if-shipping-cost-is-included").hide(),e(".smartbill-public-invoice").click((function(t){1==e(this).val()?e(".public-invoice-name").show():e(".public-invoice-name").hide()})),0==e(".smartbill-public-invoice").val()&&e(".public-invoice-name").hide(),e(".smartbill-discount-name").click((function(t){1==e(this).val()?e(".discount_text").show():e(".discount_text").hide()})),0==e(".smartbill-discount-name").val()&&e(".discount_text").hide(),e(".issue_with_due_date").click((function(t){1==e(this).val()?e(".smartbill-show-if-due-days-on").show():e(".smartbill-show-if-due-days-on").hide()})),1==e(".issue_with_due_date").val()&&e(".smartbill-show-if-due-days-on").show(),e(".smartbill-delegate-data").click((function(t){"1"==e(this).val()?e(".smartbill-show-if-add-delegate-data-on").show():e(".smartbill-show-if-add-delegate-data-on").hide()})),"0"==e(".smartbill-delegate-data").val()&&e(".smartbill-show-if-add-delegate-data-on").hide();const c=e=>new Promise((t=>setTimeout(t,e)));async function u(t){if(t.preventDefault(),t.detail&&1!=t.detail)return!1;var a={data:{order_id:smartbill.post_id},security:smartbill.security,action:"smartbill_woocommerce_send_document_mail"};"order"in e(t.currentTarget).data()&&(a.data.order_id=e(t.currentTarget).data().order),await m(a,!1,!0).then((function(){window.location.reload()}))}async function m(r,s,o){let l;var c=document.createElement("div");return c.innerHTML="Va rugam asteptati raspunsul serverului...",1==o&&Swal.fire({title:"Se incarca!",html:c,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1}),l=await e.post(ajaxurl,r,(function(e){if((e=JSON.parse(e))&&e.status)void 0!==s&&s?(0!=t?t=["Documentele au fost trimise cu succes catre clienti."]:t.push(e.message),i()):(t.push(e.message),i());else{var r=document.createElement("span");r.innerHTML=n(e.error),a.push("Eroare! "+r.innerText.replace("Smart Bill","SmartBill").replace("SmartBill Cloud","SmartBill"))}return 1==o&&Swal.close(),i(),t})),l}async function d(r,s,o){let l;if(e("#smartbill-woocommerce-invoice-button").css("background",'#f3f5f6 url("/wp-admin/images/spinner.gif") no-repeat left center'),e("#smartbill-woocommerce-invoice-button").css("padding-left","25px"),1==o){var c=document.createElement("div");c.innerHTML="Va rugam asteptati raspunsul serverului...",Swal.fire({title:"Se incarca!",html:c,icon:"info",buttonsStyling:!0,reverseButtons:!0,showConfirmButton:!1})}return l=await e.post(ajaxurl,r,(function(l){if(l=JSON.parse(l),e("html,body").animate({scrollTop:0},"slow"),l&&l.status)e("#smartbill-woocommerce-invoice-button").css("background","none"),e("#smartbill-woocommerce-invoice-button").css("background-color","#f3f5f6"),e("#smartbill-woocommerce-invoice-button").css("padding-left","10px"),e("#smartbill-woocommerce-invoice-button").css("border-color","#007cba"),e("#smartbill-woocommerce-invoice-button").css("box-shadow","0 0 0 1px #007cba"),e("#smartbill-woocommerce-invoice-button").css("outline","2px solid transparent"),e("#smartbill-woocommerce-invoice-button").css("outline-offset","0"),1==o&&Swal.close(),"undefine"!=typeof s&&s?(0!=t.length?t=["Documentele au fost emise cu succes in SmartBill."]:t.push(l.message),i()):(t.push(l.message),i());else{e("#smartbill-woocommerce-invoice-button").css("background-image","none"),e("#smartbill-woocommerce-invoice-button").css("padding-left","10px");var c=document.createElement("span");c.innerHTML=n(l.message),1==o&&Swal.close();var u=c.innerText.replace("Smart Bill","SmartBill").replace("SmartBill Cloud","SmartBill");"Verifica setarile modulului SmartBill"==u?a.push("Factura pentru comanda #"+r.data.order_id+" nu a fost emisa in SmartBill. <br/>"+c.innerText.replace("Smart Bill","SmartBill").replace("SmartBill Cloud","SmartBill")+"."):""==u?a.push("A aparut o eroare la contactarea serverului SmartBill. Acceseaza cloud.smartbill.ro, anuleaza factura pentru comanda #"+r.data.order_id+" si incearca din nou facturarea comenzii din magazinul online."):a.push("Factura pentru comanda #"+r.data.order_id+" nu a fost emisa in SmartBill. <br/> Eroare "+c.innerText.replace("Smart Bill","SmartBill").replace("SmartBill Cloud","SmartBill")+"."),i()}return t})),l}e("a#smartbill-woocommerce-invoice-button").click(o),e("a.smartbill-woocommerce-invoice-button").click(o),e("a#smartbill-woocommerce-send-document-email-button").click(u),e("a.smartbill-woocommerce-send-document-email-button").click(u);var f="1";e("select.smartbill_display_company_info").val()==f?e(".smartbill-show-if-company-info").show():e(".smartbill-show-if-company-info").hide(),e("select.smartbill_display_company_info").on("change",(function(t){this.value===f?e(".smartbill-show-if-company-info").show():e(".smartbill-show-if-company-info").hide()})),e("#smartbill_settings_display_um").find("option:selected").length&&"no_value"==e("#smartbill_settings_display_um").find("option:selected")[0].value&&e("#smartbill_settings_display_um").closest("tr").find(".settings-font-size").first().addClass("smartbill-error-highlight"),e("select.smartbill_display_send_mail_with_document").val()==f?e(".smartbill-show-if-send-mail").show():e(".smartbill-show-if-send-mail").hide(),e("select.smartbill_display_send_mail_with_document").on("change",(function(t){this.value===f?e(".smartbill-show-if-send-mail").show():e(".smartbill-show-if-send-mail").hide()})),e("select#smartbill_plugin_options_settings_document_type").val()!=f?(e(".smartbill-show-if-type-invoice").show(),e('label[for="smartbill-display-payment-url"]').text('Afiseaza buton "Plateste cu cardul" pe factura')):(e(".smartbill-show-if-type-invoice").hide(),e('label[for="smartbill-display-payment-url"]').text('Afiseaza buton "Plateste cu cardul" pe proforma')),e("select#smartbill_plugin_options_settings_document_type").on("change",(function(t){this.value!==f?(e(".smartbill-show-if-type-invoice").show(),e('label[for="smartbill-display-payment-url"]').text('Afiseaza buton "Plateste cu cardul" pe factura')):(e(".smartbill-show-if-type-invoice").hide(),e('label[for="smartbill-display-payment-url"]').text('Afiseaza buton "Plateste cu cardul" pe proforma')),function(t){e("#smartbill_plugin_options_settings_document_series").find("option").each((function(){-1!=e(this).val()&&e(this).remove()}));var a,i="",n="";if(0==t){for(var r in a=smartbill.selected_invoice_series,smartbill.invoice_series)n="",r==a&&(n=' selected="selected" '),i='<option value="'+r+'" '+n+">"+smartbill.invoice_series[r]+"</option>",e("#smartbill_plugin_options_settings_document_series").append(i);e("#smartbill_plugin_options_settings_document_series").attr("name","smartbill_plugin_options_settings[invoice_series]")}else if(1==t){for(var r in a=smartbill.selected_estimate_series,smartbill.estimate_series)n="",r==a&&(n=' selected="selected" '),i='<option value="'+r+'" '+n+">"+smartbill.estimate_series[r]+"</option>",e("#smartbill_plugin_options_settings_document_series").append(i);e("#smartbill_plugin_options_settings_document_series").attr("name","smartbill_plugin_options_settings[estimate_series]")}}(this.value)})),e("select.smartbill_display_save_stock_history").val()!=f?e("#smartbill-download-sync-stock-history").hide():e("#smartbill-download-sync-stock-history").show(),e("select.smartbill_display_save_stock_history").on("change",(function(t){this.value!==f?e("#smartbill-download-sync-stock-history").hide():e("#smartbill-download-sync-stock-history").show()})),e(".smartbill_billing_nr_reg_com_field").css({float:"right",clear:"right"}),e("._billing_company_field").after(e(".smartbill_billing_cif_field").first()),e(".smartbill_billing_cif_field").first().after(e(".smartbill_billing_nr_reg_com_field").first()),e("div.edit_address").first().prepend(e(".smartbill_billing_type_field").first()),e(".smartbill_shipping_nr_reg_com_field").css({float:"right",clear:"right"}),e("._shipping_company_field").after(e(".smartbill_shipping_cif_field").first()),e(".smartbill_shipping_cif_field").first().after(e(".smartbill_shipping_nr_reg_com_field").first()),e("div.edit_address").last().prev().prepend(e(".smartbill_shipping_type_field").first())}))}(jQuery);